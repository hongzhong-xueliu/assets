<!DOCTYPE html>

<head>
    <link rel="stylesheet" href="3d.css">
    <link rel="stylesheet" href="river.css">
</head>

<body style="background-color: #3f7528;">
    <template id="piece-template">
        <div class="three-d piece-obj">
            <div class="face face1"><img src="./assets/5筒.png" height="80"></div>
            <div class="face face2"></div>
            <div class="face side-faceA"></div>
            <div class="face side-faceB"></div>
            <div class="face side-faceC"></div>
            <div class="face side-faceD"></div>
        </div>
    </template>

    <div id="麻雀卓" style="perspective: 2400px; position: relative;">
        <div id="全員-河" class="three-d" style="transform: rotate3d(1, 0, 0, 50deg)">
            <div id="自家-河" class="three-d" style="transform: translate(var(--自家-left), var(--自家-top));">
            </div>
            <div id="下家-河" class="three-d"
                style="transform: translate(var(--下家-left), var(--下家-bottom)) rotateZ(-90deg);">
            </div>
            <div id="対面-河" class="three-d"
                style="transform: translate(var(--対面-right), var(--対面-bottom)) rotateZ(-180deg);">
            </div>
            <div id="上家-河" class="three-d"
                style="transform: translate(var(--上家-right), var(--上家-top)) rotateZ(-270deg);">
            </div>
        </div>
    </div>

    <script>
        const pieceTemplate = document.getElementById('piece-template');
        const river = document.getElementById('全員-河');

        const 自家河 = document.getElementById('自家-河');
        const 下家河 = document.getElementById('下家-河');
        const 対面河 = document.getElementById('対面-河');
        const 上家河 = document.getElementById('上家-河');

        const rivers = [
            {
                dom: 自家河,
                pieces: ["9萬", "3萬", "1萬", "5萬", "1索", "2索", "4索", "6索", "1萬", "7索", "7索", "7萬"],
            },
            {
                dom: 下家河,
                pieces: ["3萬", "5萬", "7萬", "2萬", "4索", "2索", "2索", "7索", "8索", "3索", "4索"],
            },
            {
                dom: 対面河,
                pieces: ["3萬", "1萬", "5萬", "9索", "4索", "1索", "7萬", "6索", "6索", "9索", "6索", "1索"],
            },
            {
                dom: 上家河,
                pieces: ["4筒", "9索", "1索", "5索", "5索", "3萬", "1萬", "9索", "7索", "7萬", "4索", "5索", "4筒", "5索"],
            },
        ];

        rivers.forEach(({ dom, pieces }) => {
            pieces.forEach((identity, index) => {
                const column = index % 6;
                const row = Math.floor(index / 6);
                const piece = pieceTemplate.content.cloneNode(true).children[0];
                piece.style.transform = `translateX(calc(var(--piece-horizontal-stride) * ${column})) translateY(calc(var(--piece-vertical-stride) * ${row}))`;
                piece.querySelector('img').src = `./assets/${identity}.png`;
                dom.appendChild(piece);
            });
        });
    </script>

    <div style="perspective: 1200px; position: relative;">
        <div id="自家-手牌" class="three-d" style="transform: rotate3d(1, 0, 0, 2deg) translate(130px, 800px)">
        </div>
    </div>

    <script>
        const 自家手牌 = document.getElementById('自家-手牌');
        const 自家手牌pieces = ["1筒", "1筒", "1筒", "3筒", "3筒", "6筒", "6筒", "7筒", "9筒", "9筒", "9筒", "中", "中"];

        自家手牌pieces.forEach((identity, x) => {
            const piece = pieceTemplate.content.cloneNode(true).children[0];
            piece.style.transform = `translateX(calc(var(--piece-horizontal-stride) * ${x}))`;
            piece.querySelector('img').src = `./assets/${identity}.png`;
            自家手牌.appendChild(piece);
        });

    </script>

</body>